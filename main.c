#include "sim.h"

int main() {
    SIM sim;
    init_sim(&sim, 0x020);
    /* test code
    * addi a0, zero, 0 : 000000000000 00000 000 01010 0010011
    * addi a1, a0, 4   : 000000000100 01010 000 01011 0010011
    * addi a2, a1, 4   : 000000000100 01011 000 01100 0010011
    * lw t0, 0(a0)     : 000000000000 01010 010 00101 0000011
    * lw t1, 0(a1)     : 000000000000 01011 010 00110 0000011
    * add t2, t0, t1   : 0000000 00110 00101 000 00111 0110011
    * sw t2, 0(a2)     : 0000000 00111 01100 010 00000 0100011
    * simple calculation: 1 + 2 = 3 */
    sim.core->store(0x000, 1, 2);
    sim.core->store(0x004, 2, 2);
    sim.core->store(0x020, 0b00000000000000000000010100010011, 2);
    sim.core->store(0x024, 0b00000000010001010000010110010011, 2);
    sim.core->store(0x028, 0b00000000010001011000011000010011, 2);
    sim.core->store(0x02C, 0b00000000000001010010001010000011, 2);
    sim.core->store(0x030, 0b00000000000001011010001100000011, 2);
    sim.core->store(0x034, 0b00000000011000101000001110110011, 2);
    sim.core->store(0x038, 0b00000000011101100010000000100011, 2);

    sim.run();
    
    return 0;
}
